<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
  <title>随手记 - 多用户记账</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div id="app">
    <div id="login-page" class="page">
      <header class="header">
        <h1>随手记</h1>
        <p class="subtitle">多用户记账</p>
      </header>
      <div class="card">
        <div class="tabs">
          <button type="button" class="tab active" data-tab="login">登录</button>
          <button type="button" class="tab" data-tab="register">注册</button>
        </div>
        <form id="login-form" class="form">
          <input type="text" name="username" placeholder="用户名" required autocomplete="username" />
          <input type="password" name="password" placeholder="密码" required autocomplete="current-password" />
          <button type="submit" class="btn primary">登录</button>
        </form>
        <form id="register-form" class="form hidden">
          <input type="text" name="username" placeholder="用户名（至少2位）" required />
          <input type="password" name="password" placeholder="密码（至少6位）" required />
          <button type="submit" class="btn primary">注册</button>
        </form>
      </div>
      <p id="auth-msg" class="msg"></p>
    </div>

    <div id="main-page" class="page hidden">
      <header class="header bar">
        <span class="user">欢迎，<strong id="nav-username"></strong></span>
        <button type="button" id="logout-btn" class="btn small">退出</button>
      </header>
      <section id="period-nav" class="period-nav">
        <button type="button" id="period-prev" class="btn period-btn">‹</button>
        <span id="period-label" class="period-label"></span>
        <button type="button" id="period-next" class="btn period-btn">›</button>
      </section>
      <section class="filter" id="filter-section">
        <span class="filter-dates hidden" id="filter-dates">
          <input type="date" id="filter-start" />
          <input type="date" id="filter-end" />
        </span>
        <input type="hidden" id="filter-type" value="" />
      </section>
      <section class="summary">
        <div class="summary-item income">
          <span class="label">收入</span>
          <span id="sum-income" class="amount">0.00</span>
        </div>
        <div class="summary-item expense">
          <span class="label">支出</span>
          <span id="sum-expense" class="amount">0.00</span>
        </div>
        <div class="summary-item balance">
          <span class="label">结余</span>
          <span id="sum-balance" class="amount">0.00</span>
        </div>
      </section>
      <section id="calendar-wrap" class="calendar-wrap hidden"></section>
      <section class="list-wrap">
        <ul id="record-list" class="record-list"></ul>
        <p id="list-empty" class="empty hidden">暂无记录</p>
      </section>
      <section class="bottom-actions">
        <div class="filter-buttons">
          <button type="button" id="filter-btn" class="btn small hidden">查询</button>
        </div>
        <div class="record-buttons">
          <button type="button" id="add-income" class="btn add income">+ 记收入</button>
          <button type="button" id="filter-type-btn" class="btn filter-type-btn">
            <span id="filter-type-label">全部</span>
          </button>
          <button type="button" id="add-expense" class="btn add expense">+ 记支出</button>
        </div>
      </section>
      <section class="view-tabs">
        <button type="button" class="view-tab active" data-view="list">列表</button>
        <button type="button" class="view-tab" data-view="week">周视图</button>
        <button type="button" class="view-tab" data-view="month">月视图</button>
        <button type="button" class="view-tab" data-view="year">年视图</button>
      </section>
    </div>
  </div>

  <div id="modal" class="record-modal hidden">
    <div class="record-modal-backdrop"></div>
    <div class="record-modal-content">
      <h3 id="modal-title">记一笔</h3>
      <form id="record-form">
        <input type="hidden" name="type" value="expense" />
        <input type="text" id="record-date" name="record_date" required readonly placeholder="日期" />
        <input type="text" id="category-btn" name="category" readonly placeholder="分类" />
        <input type="number" name="amount" step="0.01" min="0.01" placeholder="金额" required />
        <input type="text" name="note" placeholder="备注" />
        <div class="modal-actions">
          <button type="button" id="modal-cancel" class="btn">取消</button>
          <button type="submit" class="btn primary">保存</button>
        </div>
      </form>
    </div>
  </div>

  <div id="date-picker-modal" class="picker-modal hidden">
    <div class="picker-modal-backdrop"></div>
    <div class="picker-modal-content date-picker">
      <h3 class="picker-title">选择日期</h3>
      <div class="date-wheel-row">
        <div class="date-wheel" id="date-wheel-year" aria-label="年"></div>
        <div class="date-wheel" id="date-wheel-month" aria-label="月"></div>
        <div class="date-wheel" id="date-wheel-day" aria-label="日"></div>
      </div>
      <div class="picker-actions">
        <button type="button" id="date-picker-cancel" class="btn">取消</button>
        <button type="button" id="date-picker-ok" class="btn primary">确定</button>
      </div>
    </div>
  </div>

  <div id="category-picker-modal" class="picker-modal hidden">
    <div class="picker-modal-backdrop"></div>
    <div class="picker-modal-content">
      <h3 class="picker-title">选择分类</h3>
      <div class="picker-options">
        <!-- 选项将由 JS 动态生成：默认分类 + DB distinct 分类 -->
      </div>
      <div class="category-custom">
        <input type="text" id="category-custom-input" placeholder="自定义分类（可输入）" maxlength="50" />
        <button type="button" id="category-custom-ok" class="btn small primary">使用</button>
      </div>
      <button type="button" id="category-picker-cancel" class="btn picker-cancel">取消</button>
    </div>
  </div>

  <div id="type-picker-modal" class="picker-modal hidden">
    <div class="picker-modal-backdrop"></div>
    <div class="picker-modal-content">
      <h3 class="picker-title">选择类型</h3>
      <div class="picker-options">
        <button type="button" class="picker-option" data-value="">全部</button>
        <button type="button" class="picker-option" data-value="income">收入</button>
        <button type="button" class="picker-option" data-value="expense">支出</button>
      </div>
      <button type="button" id="picker-cancel" class="btn picker-cancel">取消</button>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
